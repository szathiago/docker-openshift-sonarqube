{"version":3,"sources":["webpack:///./src/main/js/apps/component/components/App.tsx","webpack:///./src/main/js/components/SourceViewer/SourceViewer.tsx"],"names":["App","_super","_this","apply","this","arguments","scrollToLine","line","props","location","query","row","document","querySelector","rect","getBoundingClientRect","topOffset","window","innerHeight","goal","top","scrollTo","__extends","prototype","render","_a","branch","id","pullRequest","finalLine","Number","undefined","fakeBranchLike","Object","_helpers_branches__WEBPACK_IMPORTED_MODULE_2__","react__WEBPACK_IMPORTED_MODULE_0__","className","_components_SourceViewer_SourceViewer__WEBPACK_IMPORTED_MODULE_1__","aroundLine","branchLike","component","highlightedLine","onLoaded","mapDispatchToProps","onReceiveComponent","dispatch","canMarkAsFavorite","favorites","notFavorites","fav","push","key","_store_favorites_duck__WEBPACK_IMPORTED_MODULE_2__","__webpack_exports__","react_redux__WEBPACK_IMPORTED_MODULE_0__","_lazyLoad__WEBPACK_IMPORTED_MODULE_1__","Promise","all","__webpack_require__","e","then","bind"],"mappings":"2ZAkCAA,EAAA,SAAAC,GAAA,SAAAD,IAAA,IAAAE,EAAA,OAAAD,KAAAE,MAAAC,KAAAC,YAAAD,YACEF,EAAAI,aAAe,WACL,IAAAC,EAAAL,EAAAM,MAAAC,SAAAC,MAAAH,KACR,GAAIA,EAAM,CACR,IAAMI,EAAMC,SAASC,cAAc,kCAAkCN,EAAI,MACzE,GAAII,EAAK,CACP,IAAMG,EAAOH,EAAII,wBACXC,EAAYC,OAAOC,YAAc,EAAI,GACrCC,EAAOL,EAAKM,IAAMJ,EACxBC,OAAOI,SAAS,EAAGF,QA2B3B,OApCiCG,EAAAtB,EAAAC,GAc/BD,EAAAuB,UAAAC,OAAA,WACQ,IAAAC,EAAArB,KAAAI,MAAAC,SAAAC,MAAEgB,EAAAD,EAAAC,OAAQC,EAAAF,EAAAE,GAAIpB,EAAAkB,EAAAlB,KAAMqB,EAAAH,EAAAG,YAEpBC,EAAYtB,EAAOuB,OAAOvB,QAAQwB,EAKlCC,EAAiBC,OAAAC,EAAA,EAAAD,CAAeP,EAAQE,GAE9C,OACEO,EAAA,qBAAKC,UAAU,qBACbD,EAAA,cAACE,EAAA,GACCC,WAAYT,EACZU,WAAYP,EACZQ,UAAWb,EACXc,gBAAiBZ,EACjBa,SAAUtC,KAAKE,iBAKzBN,EApCA,CAAiCmC,EAAA,4FCW3BQ,GAAsCC,mBAbjB,SAACJ,GAAgC,gBAACK,GAC3D,GAAIL,EAAUM,kBAAmB,CAC/B,IAAMC,KACAC,KACFR,EAAUS,IACZF,EAAUG,MAAOC,IAAKX,EAAUW,MAEhCH,EAAaE,MAAOC,IAAKX,EAAUW,MAErCN,EAASZ,OAAAmB,EAAA,EAAAnB,CAAiBc,EAAWC,QAQzCK,EAAA,EAAepB,OAAAqB,EAAA,QAAArB,CAvBS,KAuB+CU,EAAvE,CACEV,OAAAsB,EAAA,EAAAtB,CAAS,WAAM,OAAAuB,QAAAC,KAAAC,EAAAC,EAAA,KAAAD,EAAAC,EAAA,KAAAD,EAAAC,EAAA,OAAAC,KAAAF,EAAAG,KAAA","file":"js/322.a68a6210.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport SourceViewer from '../../../components/SourceViewer/SourceViewer';\nimport { fillBranchLike } from '../../../helpers/branches';\n\ninterface Props {\n  location: {\n    query: {\n      branch?: string;\n      id: string;\n      line?: string;\n      pullRequest?: string;\n    };\n  };\n}\n\nexport default class App extends React.PureComponent<Props> {\n  scrollToLine = () => {\n    const { line } = this.props.location.query;\n    if (line) {\n      const row = document.querySelector(`.source-line[data-line-number=\"${line}\"]`);\n      if (row) {\n        const rect = row.getBoundingClientRect();\n        const topOffset = window.innerHeight / 2 - 60;\n        const goal = rect.top - topOffset;\n        window.scrollTo(0, goal);\n      }\n    }\n  };\n\n  render() {\n    const { branch, id, line, pullRequest } = this.props.location.query;\n\n    const finalLine = line ? Number(line) : undefined;\n\n    // TODO find a way to avoid creating this fakeBranchLike\n    // probably the best way would be to drop this page completely\n    // and redirect to the Code page\n    const fakeBranchLike = fillBranchLike(branch, pullRequest);\n\n    return (\n      <div className=\"page page-limited\">\n        <SourceViewer\n          aroundLine={finalLine}\n          branchLike={fakeBranchLike}\n          component={id}\n          highlightedLine={finalLine}\n          onLoaded={this.scrollToLine}\n        />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { Dispatch } from 'redux';\nimport { connect, Omit } from 'react-redux';\nimport { Props } from './SourceViewerBase';\nimport { lazyLoad } from '../lazyLoad';\nimport { SourceViewerFile } from '../../app/types';\nimport { receiveFavorites } from '../../store/favorites/duck';\n\nconst mapStateToProps = null;\n\ninterface DispatchProps {\n  onReceiveComponent: (component: SourceViewerFile) => void;\n}\n\nconst onReceiveComponent = (component: SourceViewerFile) => (dispatch: Dispatch<any>) => {\n  if (component.canMarkAsFavorite) {\n    const favorites = [];\n    const notFavorites = [];\n    if (component.fav) {\n      favorites.push({ key: component.key });\n    } else {\n      notFavorites.push({ key: component.key });\n    }\n    dispatch(receiveFavorites(favorites, notFavorites));\n  }\n};\n\nconst mapDispatchToProps: DispatchProps = { onReceiveComponent };\n\ntype OwnProps = Omit<Props, keyof DispatchProps>;\n\nexport default connect<null, DispatchProps, OwnProps>(mapStateToProps, mapDispatchToProps)(\n  lazyLoad(() => import(/* webpackPrefetch: true */ './SourceViewerBase'))\n);\n"],"sourceRoot":""}